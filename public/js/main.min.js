!function t(e,n,r){function o(i,s){if(!n[i]){if(!e[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return o(n?n:t)},c,c.exports,t,e,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(t,e,n){},{}],2:[function(t,e,n){n.glMatrix=t("./gl-matrix/common.js"),n.mat2=t("./gl-matrix/mat2.js"),n.mat2d=t("./gl-matrix/mat2d.js"),n.mat3=t("./gl-matrix/mat3.js"),n.mat4=t("./gl-matrix/mat4.js"),n.quat=t("./gl-matrix/quat.js"),n.vec2=t("./gl-matrix/vec2.js"),n.vec3=t("./gl-matrix/vec3.js"),n.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":3,"./gl-matrix/mat2.js":4,"./gl-matrix/mat2d.js":5,"./gl-matrix/mat3.js":6,"./gl-matrix/mat4.js":7,"./gl-matrix/quat.js":8,"./gl-matrix/vec2.js":9,"./gl-matrix/vec3.js":10,"./gl-matrix/vec4.js":11}],3:[function(t,e,n){var r={};r.EPSILON=1e-6,r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,r.RANDOM=Math.random,r.ENABLE_SIMD=!1,r.SIMD_AVAILABLE=r.ARRAY_TYPE===Float32Array&&"SIMD"in this,r.USE_SIMD=r.ENABLE_SIMD&&r.SIMD_AVAILABLE,r.setMatrixArrayType=function(t){r.ARRAY_TYPE=t};var o=Math.PI/180;r.toRadian=function(t){return t*o},r.equals=function(t,e){return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.exports=r},{}],4:[function(t,e,n){var r=t("./common.js"),o={};o.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},o.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},o.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},o.fromValues=function(t,e,n,o){var a=new r.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=o,a},o.set=function(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t},o.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},o.invert=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=n*a-o*r;return i?(i=1/i,t[0]=a*i,t[1]=-r*i,t[2]=-o*i,t[3]=n*i,t):null},o.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},o.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},o.multiply=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=r*s+a*u,t[1]=o*s+i*u,t[2]=r*l+a*c,t[3]=o*l+i*c,t},o.mul=o.multiply,o.rotate=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=o*u+i*s,t[2]=r*-s+a*u,t[3]=o*-s+i*u,t},o.scale=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=o*s,t[2]=a*u,t[3]=i*u,t},o.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},o.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},o.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},o.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},o.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},o.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},o.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},o.sub=o.subtract,o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},o.equals=function(t,e){var n=t[0],o=t[1],a=t[2],i=t[3],s=e[0],u=e[1],l=e[2],c=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-u)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(a-l)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(i-c)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},o.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},o.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},e.exports=o},{"./common.js":3}],5:[function(t,e,n){var r=t("./common.js"),o={};o.create=function(){var t=new r.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},o.clone=function(t){var e=new r.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},o.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},o.fromValues=function(t,e,n,o,a,i){var s=new r.ARRAY_TYPE(6);return s[0]=t,s[1]=e,s[2]=n,s[3]=o,s[4]=a,s[5]=i,s},o.set=function(t,e,n,r,o,a,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=i,t},o.invert=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],u=n*a-r*o;return u?(u=1/u,t[0]=a*u,t[1]=-r*u,t[2]=-o*u,t[3]=n*u,t[4]=(o*s-a*i)*u,t[5]=(r*i-n*s)*u,t):null},o.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},o.multiply=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=e[4],u=e[5],l=n[0],c=n[1],h=n[2],f=n[3],d=n[4],p=n[5];return t[0]=r*l+a*c,t[1]=o*l+i*c,t[2]=r*h+a*f,t[3]=o*h+i*f,t[4]=r*d+a*p+s,t[5]=o*d+i*p+u,t},o.mul=o.multiply,o.rotate=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=e[4],u=e[5],l=Math.sin(n),c=Math.cos(n);return t[0]=r*c+a*l,t[1]=o*c+i*l,t[2]=r*-l+a*c,t[3]=o*-l+i*c,t[4]=s,t[5]=u,t},o.scale=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=e[4],u=e[5],l=n[0],c=n[1];return t[0]=r*l,t[1]=o*l,t[2]=a*c,t[3]=i*c,t[4]=s,t[5]=u,t},o.translate=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=e[4],u=e[5],l=n[0],c=n[1];return t[0]=r,t[1]=o,t[2]=a,t[3]=i,t[4]=r*l+a*c+s,t[5]=o*l+i*c+u,t},o.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},o.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},o.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},o.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},o.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},o.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},o.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t},o.sub=o.subtract,o.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},o.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},o.equals=function(t,e){var n=t[0],o=t[1],a=t[2],i=t[3],s=t[4],u=t[5],l=e[0],c=e[1],h=e[2],f=e[3],d=e[4],p=e[5];return Math.abs(n-l)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-h)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(i-f)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(s-d)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(u-p)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))},e.exports=o},{"./common.js":3}],6:[function(t,e,n){var r=t("./common.js"),o={};o.create=function(){var t=new r.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},o.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},o.clone=function(t){var e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},o.fromValues=function(t,e,n,o,a,i,s,u,l){var c=new r.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=o,c[4]=a,c[5]=i,c[6]=s,c[7]=u,c[8]=l,c},o.set=function(t,e,n,r,o,a,i,s,u,l){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=i,t[6]=s,t[7]=u,t[8]=l,t},o.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},o.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},o.invert=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=c*i-s*l,f=-c*a+s*u,d=l*a-i*u,p=n*h+r*f+o*d;return p?(p=1/p,t[0]=h*p,t[1]=(-c*r+o*l)*p,t[2]=(s*r-o*i)*p,t[3]=f*p,t[4]=(c*n-o*u)*p,t[5]=(-s*n+o*a)*p,t[6]=d*p,t[7]=(-l*n+r*u)*p,t[8]=(i*n-r*a)*p,t):null},o.adjoint=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],u=e[6],l=e[7],c=e[8];return t[0]=i*c-s*l,t[1]=o*l-r*c,t[2]=r*s-o*i,t[3]=s*u-a*c,t[4]=n*c-o*u,t[5]=o*a-n*s,t[6]=a*l-i*u,t[7]=r*u-n*l,t[8]=n*i-r*a,t},o.determinant=function(t){var e=t[0],n=t[1],r=t[2],o=t[3],a=t[4],i=t[5],s=t[6],u=t[7],l=t[8];return e*(l*a-i*u)+n*(-l*o+i*s)+r*(u*o-a*s)},o.multiply=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=n[0],d=n[1],p=n[2],m=n[3],M=n[4],x=n[5],_=n[6],g=n[7],S=n[8];return t[0]=f*r+d*i+p*l,t[1]=f*o+d*s+p*c,t[2]=f*a+d*u+p*h,t[3]=m*r+M*i+x*l,t[4]=m*o+M*s+x*c,t[5]=m*a+M*u+x*h,t[6]=_*r+g*i+S*l,t[7]=_*o+g*s+S*c,t[8]=_*a+g*u+S*h,t},o.mul=o.multiply,o.translate=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=n[0],d=n[1];return t[0]=r,t[1]=o,t[2]=a,t[3]=i,t[4]=s,t[5]=u,t[6]=f*r+d*i+l,t[7]=f*o+d*s+c,t[8]=f*a+d*u+h,t},o.rotate=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=Math.sin(n),d=Math.cos(n);return t[0]=d*r+f*i,t[1]=d*o+f*s,t[2]=d*a+f*u,t[3]=d*i-f*r,t[4]=d*s-f*o,t[5]=d*u-f*a,t[6]=l,t[7]=c,t[8]=h,t},o.scale=function(t,e,n){var r=n[0],o=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},o.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},o.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},o.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},o.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},o.fromQuat=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=n+n,s=r+r,u=o+o,l=n*i,c=r*i,h=r*s,f=o*i,d=o*s,p=o*u,m=a*i,M=a*s,x=a*u;return t[0]=1-h-p,t[3]=c-x,t[6]=f+M,t[1]=c+x,t[4]=1-l-p,t[7]=d-m,t[2]=f-M,t[5]=d+m,t[8]=1-l-h,t},o.normalFromMat4=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],M=e[14],x=e[15],_=n*s-r*i,g=n*u-o*i,S=n*l-a*i,b=r*u-o*s,v=r*l-a*s,I=o*l-a*u,D=c*m-h*p,F=c*M-f*p,y=c*x-d*p,w=h*M-f*m,E=h*x-d*m,T=f*x-d*M,A=_*T-g*E+S*w+b*y-v*F+I*D;return A?(A=1/A,t[0]=(s*T-u*E+l*w)*A,t[1]=(u*y-i*T-l*F)*A,t[2]=(i*E-s*y+l*D)*A,t[3]=(o*E-r*T-a*w)*A,t[4]=(n*T-o*y+a*F)*A,t[5]=(r*y-n*E-a*D)*A,t[6]=(m*I-M*v+x*b)*A,t[7]=(M*S-p*I-x*g)*A,t[8]=(p*v-m*S+x*_)*A,t):null},o.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},o.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},o.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},o.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t},o.sub=o.subtract,o.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},o.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},o.equals=function(t,e){var n=t[0],o=t[1],a=t[2],i=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=e[0],d=e[1],p=e[2],m=e[3],M=e[4],x=e[5],_=t[6],g=e[7],S=e[8];return Math.abs(n-f)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(o-d)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-p)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(i-m)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-M)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-x)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(l-_)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(c-g)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-S)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))},e.exports=o},{"./common.js":3}],7:[function(t,e,n){var r=t("./common.js"),o={scalar:{},SIMD:{}};o.create=function(){var t=new r.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.clone=function(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.fromValues=function(t,e,n,o,a,i,s,u,l,c,h,f,d,p,m,M){var x=new r.ARRAY_TYPE(16);return x[0]=t,x[1]=e,x[2]=n,x[3]=o,x[4]=a,x[5]=i,x[6]=s,x[7]=u,x[8]=l,x[9]=c,x[10]=h,x[11]=f,x[12]=d,x[13]=p,x[14]=m,x[15]=M,x},o.set=function(t,e,n,r,o,a,i,s,u,l,c,h,f,d,p,m,M){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=i,t[6]=s,t[7]=u,t[8]=l,t[9]=c,t[10]=h,t[11]=f,t[12]=d,t[13]=p,t[14]=m,t[15]=M,t},o.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.scalar.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],o=e[3],a=e[6],i=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=o,t[13]=i,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},o.SIMD.transpose=function(t,e){var n,r,o,a,i,s,u,l,c,h;return n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),i=SIMD.Float32x4.shuffle(n,r,0,1,4,5),s=SIMD.Float32x4.shuffle(o,a,0,1,4,5),u=SIMD.Float32x4.shuffle(i,s,0,2,4,6),l=SIMD.Float32x4.shuffle(i,s,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,l),i=SIMD.Float32x4.shuffle(n,r,2,3,6,7),s=SIMD.Float32x4.shuffle(o,a,2,3,6,7),c=SIMD.Float32x4.shuffle(i,s,0,2,4,6),h=SIMD.Float32x4.shuffle(i,s,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,h),t},o.transpose=r.USE_SIMD?o.SIMD.transpose:o.scalar.transpose,o.scalar.invert=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],M=e[14],x=e[15],_=n*s-r*i,g=n*u-o*i,S=n*l-a*i,b=r*u-o*s,v=r*l-a*s,I=o*l-a*u,D=c*m-h*p,F=c*M-f*p,y=c*x-d*p,w=h*M-f*m,E=h*x-d*m,T=f*x-d*M,A=_*T-g*E+S*w+b*y-v*F+I*D;return A?(A=1/A,t[0]=(s*T-u*E+l*w)*A,t[1]=(o*E-r*T-a*w)*A,t[2]=(m*I-M*v+x*b)*A,t[3]=(f*v-h*I-d*b)*A,t[4]=(u*y-i*T-l*F)*A,t[5]=(n*T-o*y+a*F)*A,t[6]=(M*S-p*I-x*g)*A,t[7]=(c*I-f*S+d*g)*A,t[8]=(i*E-s*y+l*D)*A,t[9]=(r*y-n*E-a*D)*A,t[10]=(p*v-m*S+x*_)*A,t[11]=(h*S-c*v-d*_)*A,t[12]=(s*F-i*w-u*D)*A,t[13]=(n*w-r*F+o*D)*A,t[14]=(m*g-p*b-M*_)*A,t[15]=(c*b-h*g+f*_)*A,t):null},o.SIMD.invert=function(t,e){var n,r,o,a,i,s,u,l,c,h,f=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),p=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return i=SIMD.Float32x4.shuffle(f,d,0,1,4,5),r=SIMD.Float32x4.shuffle(p,m,0,1,4,5),n=SIMD.Float32x4.shuffle(i,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,i,1,3,5,7),i=SIMD.Float32x4.shuffle(f,d,2,3,6,7),a=SIMD.Float32x4.shuffle(p,m,2,3,6,7),o=SIMD.Float32x4.shuffle(i,a,0,2,4,6),a=SIMD.Float32x4.shuffle(a,i,1,3,5,7),i=SIMD.Float32x4.mul(o,a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.mul(r,i),u=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),s),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.mul(r,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),s),c=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,i)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s),l=SIMD.Float32x4.mul(n,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,i)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),i=SIMD.Float32x4.mul(n,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),l),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),c),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(o,i)),i=SIMD.Float32x4.mul(n,a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,i)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),l),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,i)),i=SIMD.Float32x4.mul(n,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,i)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),c),h=SIMD.Float32x4.mul(n,s),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,2,3,0,1),h),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,1,0,3,2),h),i=SIMD.Float32x4.reciprocalApproximation(h),h=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(h,SIMD.Float32x4.mul(i,i))),(h=SIMD.Float32x4.swizzle(h,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(h,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(h,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(h,l)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(h,c)),t):null},o.invert=r.USE_SIMD?o.SIMD.invert:o.scalar.invert,o.scalar.adjoint=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],M=e[14],x=e[15];return t[0]=s*(f*x-d*M)-h*(u*x-l*M)+m*(u*d-l*f),t[1]=-(r*(f*x-d*M)-h*(o*x-a*M)+m*(o*d-a*f)),t[2]=r*(u*x-l*M)-s*(o*x-a*M)+m*(o*l-a*u),t[3]=-(r*(u*d-l*f)-s*(o*d-a*f)+h*(o*l-a*u)),t[4]=-(i*(f*x-d*M)-c*(u*x-l*M)+p*(u*d-l*f)),t[5]=n*(f*x-d*M)-c*(o*x-a*M)+p*(o*d-a*f),t[6]=-(n*(u*x-l*M)-i*(o*x-a*M)+p*(o*l-a*u)),t[7]=n*(u*d-l*f)-i*(o*d-a*f)+c*(o*l-a*u),t[8]=i*(h*x-d*m)-c*(s*x-l*m)+p*(s*d-l*h),t[9]=-(n*(h*x-d*m)-c*(r*x-a*m)+p*(r*d-a*h)),t[10]=n*(s*x-l*m)-i*(r*x-a*m)+p*(r*l-a*s),t[11]=-(n*(s*d-l*h)-i*(r*d-a*h)+c*(r*l-a*s)),t[12]=-(i*(h*M-f*m)-c*(s*M-u*m)+p*(s*f-u*h)),t[13]=n*(h*M-f*m)-c*(r*M-o*m)+p*(r*f-o*h),t[14]=-(n*(s*M-u*m)-i*(r*M-o*m)+p*(r*u-o*s)),t[15]=n*(s*f-u*h)-i*(r*f-o*h)+c*(r*u-o*s),t},o.SIMD.adjoint=function(t,e){var n,r,o,a,i,s,u,l,c,h,f,d,p,n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(n,r,0,1,4,5),s=SIMD.Float32x4.shuffle(o,a,0,1,4,5),i=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.shuffle(n,r,2,3,6,7),l=SIMD.Float32x4.shuffle(o,a,2,3,6,7),u=SIMD.Float32x4.shuffle(c,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,c,1,3,5,7),c=SIMD.Float32x4.mul(u,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.mul(s,c),f=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),h),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.mul(s,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),p=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),p),p=SIMD.Float32x4.swizzle(p,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h),d=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(i,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),d),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),p),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),d),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(i,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.mul(i,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),p),SIMD.Float32x4.store(t,0,h),SIMD.Float32x4.store(t,4,f),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,p),t},o.adjoint=r.USE_SIMD?o.SIMD.adjoint:o.scalar.adjoint,o.determinant=function(t){var e=t[0],n=t[1],r=t[2],o=t[3],a=t[4],i=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],f=t[11],d=t[12],p=t[13],m=t[14],M=t[15],x=e*i-n*a,_=e*s-r*a,g=e*u-o*a,S=n*s-r*i,b=n*u-o*i,v=r*u-o*s,I=l*p-c*d,D=l*m-h*d,F=l*M-f*d,y=c*m-h*p,w=c*M-f*p,E=h*M-f*m;return x*E-_*w+g*y+S*F-b*D+v*I},o.SIMD.multiply=function(t,e,n){var r=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.load(n,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),i))));SIMD.Float32x4.store(t,0,u);var l=SIMD.Float32x4.load(n,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),i))));SIMD.Float32x4.store(t,4,c);var h=SIMD.Float32x4.load(n,8),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),i))));SIMD.Float32x4.store(t,8,f);var d=SIMD.Float32x4.load(n,12),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),o),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),a),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),i))));return SIMD.Float32x4.store(t,12,p),t},o.scalar.multiply=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],m=e[12],M=e[13],x=e[14],_=e[15],g=n[0],S=n[1],b=n[2],v=n[3];return t[0]=g*r+S*s+b*h+v*m,t[1]=g*o+S*u+b*f+v*M,t[2]=g*a+S*l+b*d+v*x,t[3]=g*i+S*c+b*p+v*_,g=n[4],S=n[5],b=n[6],v=n[7],t[4]=g*r+S*s+b*h+v*m,t[5]=g*o+S*u+b*f+v*M,t[6]=g*a+S*l+b*d+v*x,t[7]=g*i+S*c+b*p+v*_,g=n[8],S=n[9],b=n[10],v=n[11],t[8]=g*r+S*s+b*h+v*m,t[9]=g*o+S*u+b*f+v*M,t[10]=g*a+S*l+b*d+v*x,t[11]=g*i+S*c+b*p+v*_,g=n[12],S=n[13],b=n[14],v=n[15],t[12]=g*r+S*s+b*h+v*m,t[13]=g*o+S*u+b*f+v*M,t[14]=g*a+S*l+b*d+v*x,t[15]=g*i+S*c+b*p+v*_,t},o.multiply=r.USE_SIMD?o.SIMD.multiply:o.scalar.multiply,o.mul=o.multiply,o.scalar.translate=function(t,e,n){var r,o,a,i,s,u,l,c,h,f,d,p,m=n[0],M=n[1],x=n[2];return e===t?(t[12]=e[0]*m+e[4]*M+e[8]*x+e[12],t[13]=e[1]*m+e[5]*M+e[9]*x+e[13],t[14]=e[2]*m+e[6]*M+e[10]*x+e[14],t[15]=e[3]*m+e[7]*M+e[11]*x+e[15]):(r=e[0],o=e[1],a=e[2],i=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=o,t[2]=a,t[3]=i,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=r*m+s*M+h*x+e[12],t[13]=o*m+u*M+f*x+e[13],t[14]=a*m+l*M+d*x+e[14],t[15]=i*m+c*M+p*x+e[15]),t},o.SIMD.translate=function(t,e,n){var r=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,0,0,0,0)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,1,1,1,1)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(r,SIMD.Float32x4.add(o,SIMD.Float32x4.add(a,i)));return SIMD.Float32x4.store(t,12,u),t},o.translate=r.USE_SIMD?o.SIMD.translate:o.scalar.translate,o.scalar.scale=function(t,e,n){var r=n[0],o=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.SIMD.scale=function(t,e,n){var r,o,a,i=SIMD.Float32x4(n[0],n[1],n[2],0);return r=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(i,0,0,0,0))),o=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,1,1,1,1))),a=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(i,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.scale=r.USE_SIMD?o.SIMD.scale:o.scalar.scale,o.rotate=function(t,e,n,o){var a,i,s,u,l,c,h,f,d,p,m,M,x,_,g,S,b,v,I,D,F,y,w,E,T=o[0],A=o[1],R=o[2],P=Math.sqrt(T*T+A*A+R*R);return Math.abs(P)<r.EPSILON?null:(P=1/P,T*=P,A*=P,R*=P,a=Math.sin(n),i=Math.cos(n),s=1-i,u=e[0],l=e[1],c=e[2],h=e[3],f=e[4],d=e[5],p=e[6],m=e[7],M=e[8],x=e[9],_=e[10],g=e[11],S=T*T*s+i,b=A*T*s+R*a,v=R*T*s-A*a,I=T*A*s-R*a,D=A*A*s+i,F=R*A*s+T*a,y=T*R*s+A*a,w=A*R*s-T*a,E=R*R*s+i,t[0]=u*S+f*b+M*v,t[1]=l*S+d*b+x*v,t[2]=c*S+p*b+_*v,t[3]=h*S+m*b+g*v,t[4]=u*I+f*D+M*F,t[5]=l*I+d*D+x*F,t[6]=c*I+p*D+_*F,t[7]=h*I+m*D+g*F,t[8]=u*y+f*w+M*E,t[9]=l*y+d*w+x*E,t[10]=c*y+p*w+_*E,t[11]=h*y+m*w+g*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},o.scalar.rotateX=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),a=e[4],i=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*o+l*r,t[5]=i*o+c*r,t[6]=s*o+h*r,t[7]=u*o+f*r,t[8]=l*o-a*r,t[9]=c*o-i*r,t[10]=h*o-s*r,t[11]=f*o-u*r,t},o.SIMD.rotateX=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),o=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var a=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),SIMD.Float32x4.mul(i,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),SIMD.Float32x4.mul(a,r))),t},o.rotateX=r.USE_SIMD?o.SIMD.rotateX:o.scalar.rotateX,o.scalar.rotateY=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),a=e[0],i=e[1],s=e[2],u=e[3],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*o-l*r,t[1]=i*o-c*r,t[2]=s*o-h*r,t[3]=u*o-f*r,t[8]=a*r+l*o,t[9]=i*r+c*o,t[10]=s*r+h*o,t[11]=u*r+f*o,t},o.SIMD.rotateY=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),o=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var a=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),SIMD.Float32x4.mul(i,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,r),SIMD.Float32x4.mul(i,o))),t},o.rotateY=r.USE_SIMD?o.SIMD.rotateY:o.scalar.rotateY,o.scalar.rotateZ=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),a=e[0],i=e[1],s=e[2],u=e[3],l=e[4],c=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*o+l*r,t[1]=i*o+c*r,t[2]=s*o+h*r,t[3]=u*o+f*r,t[4]=l*o-a*r,t[5]=c*o-i*r,t[6]=h*o-s*r,t[7]=f*o-u*r,t},o.SIMD.rotateZ=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),o=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var a=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),SIMD.Float32x4.mul(i,r))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),SIMD.Float32x4.mul(a,r))),t},o.rotateZ=r.USE_SIMD?o.SIMD.rotateZ:o.scalar.rotateZ,o.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},o.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.fromRotation=function(t,e,n){var o,a,i,s=n[0],u=n[1],l=n[2],c=Math.sqrt(s*s+u*u+l*l);return Math.abs(c)<r.EPSILON?null:(c=1/c,s*=c,u*=c,l*=c,o=Math.sin(e),a=Math.cos(e),i=1-a,t[0]=s*s*i+a,t[1]=u*s*i+l*o,t[2]=l*s*i-u*o,t[3]=0,t[4]=s*u*i-l*o,t[5]=u*u*i+a,t[6]=l*u*i+s*o,t[7]=0,t[8]=s*l*i+u*o,t[9]=u*l*i-s*o,t[10]=l*l*i+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},o.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.fromRotationTranslation=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=r+r,u=o+o,l=a+a,c=r*s,h=r*u,f=r*l,d=o*u,p=o*l,m=a*l,M=i*s,x=i*u,_=i*l;return t[0]=1-(d+m),t[1]=h+_,t[2]=f-x,t[3]=0,t[4]=h-_,t[5]=1-(c+m),t[6]=p+M,t[7]=0,t[8]=f+x,t[9]=p-M,t[10]=1-(c+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},o.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},o.getRotation=function(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,
t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},o.fromRotationTranslationScale=function(t,e,n,r){var o=e[0],a=e[1],i=e[2],s=e[3],u=o+o,l=a+a,c=i+i,h=o*u,f=o*l,d=o*c,p=a*l,m=a*c,M=i*c,x=s*u,_=s*l,g=s*c,S=r[0],b=r[1],v=r[2];return t[0]=(1-(p+M))*S,t[1]=(f+g)*S,t[2]=(d-_)*S,t[3]=0,t[4]=(f-g)*b,t[5]=(1-(h+M))*b,t[6]=(m+x)*b,t[7]=0,t[8]=(d+_)*v,t[9]=(m-x)*v,t[10]=(1-(h+p))*v,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},o.fromRotationTranslationScaleOrigin=function(t,e,n,r,o){var a=e[0],i=e[1],s=e[2],u=e[3],l=a+a,c=i+i,h=s+s,f=a*l,d=a*c,p=a*h,m=i*c,M=i*h,x=s*h,_=u*l,g=u*c,S=u*h,b=r[0],v=r[1],I=r[2],D=o[0],F=o[1],y=o[2];return t[0]=(1-(m+x))*b,t[1]=(d+S)*b,t[2]=(p-g)*b,t[3]=0,t[4]=(d-S)*v,t[5]=(1-(f+x))*v,t[6]=(M+_)*v,t[7]=0,t[8]=(p+g)*I,t[9]=(M-_)*I,t[10]=(1-(f+m))*I,t[11]=0,t[12]=n[0]+D-(t[0]*D+t[4]*F+t[8]*y),t[13]=n[1]+F-(t[1]*D+t[5]*F+t[9]*y),t[14]=n[2]+y-(t[2]*D+t[6]*F+t[10]*y),t[15]=1,t},o.fromQuat=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=n+n,s=r+r,u=o+o,l=n*i,c=r*i,h=r*s,f=o*i,d=o*s,p=o*u,m=a*i,M=a*s,x=a*u;return t[0]=1-h-p,t[1]=c+x,t[2]=f-M,t[3]=0,t[4]=c-x,t[5]=1-l-p,t[6]=d+m,t[7]=0,t[8]=f+M,t[9]=d-m,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},o.frustum=function(t,e,n,r,o,a,i){var s=1/(n-e),u=1/(o-r),l=1/(a-i);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(o+r)*u,t[10]=(i+a)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*a*2*l,t[15]=0,t},o.perspective=function(t,e,n,r,o){var a=1/Math.tan(e/2),i=1/(r-o);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(o+r)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*r*i,t[15]=0,t},o.perspectiveFromFieldOfView=function(t,e,n,r){var o=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(i+s),l=2/(o+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-((i-s)*u*.5),t[9]=(o-a)*l*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},o.ortho=function(t,e,n,r,o,a,i){var s=1/(e-n),u=1/(r-o),l=1/(a-i);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(o+r)*u,t[14]=(i+a)*l,t[15]=1,t},o.lookAt=function(t,e,n,a){var i,s,u,l,c,h,f,d,p,m,M=e[0],x=e[1],_=e[2],g=a[0],S=a[1],b=a[2],v=n[0],I=n[1],D=n[2];return Math.abs(M-v)<r.EPSILON&&Math.abs(x-I)<r.EPSILON&&Math.abs(_-D)<r.EPSILON?o.identity(t):(f=M-v,d=x-I,p=_-D,m=1/Math.sqrt(f*f+d*d+p*p),f*=m,d*=m,p*=m,i=S*p-b*d,s=b*f-g*p,u=g*d-S*f,m=Math.sqrt(i*i+s*s+u*u),m?(m=1/m,i*=m,s*=m,u*=m):(i=0,s=0,u=0),l=d*u-p*s,c=p*i-f*u,h=f*s-d*i,m=Math.sqrt(l*l+c*c+h*h),m?(m=1/m,l*=m,c*=m,h*=m):(l=0,c=0,h=0),t[0]=i,t[1]=l,t[2]=f,t[3]=0,t[4]=s,t[5]=c,t[6]=d,t[7]=0,t[8]=u,t[9]=h,t[10]=p,t[11]=0,t[12]=-(i*M+s*x+u*_),t[13]=-(l*M+c*x+h*_),t[14]=-(f*M+d*x+p*_),t[15]=1,t)},o.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},o.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},o.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},o.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t},o.sub=o.subtract,o.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},o.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},o.equals=function(t,e){var n=t[0],o=t[1],a=t[2],i=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=t[9],d=t[10],p=t[11],m=t[12],M=t[13],x=t[14],_=t[15],g=e[0],S=e[1],b=e[2],v=e[3],I=e[4],D=e[5],F=e[6],y=e[7],w=e[8],E=e[9],T=e[10],A=e[11],R=e[12],P=e[13],L=e[14],O=e[15];return Math.abs(n-g)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(o-S)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(a-b)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(i-v)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(s-I)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(u-D)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(l-F)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(c-y)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(h-w)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(f-E)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(d-T)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(p-A)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(m-R)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(M-P)<=r.EPSILON*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(x-L)<=r.EPSILON*Math.max(1,Math.abs(x),Math.abs(L))&&Math.abs(_-O)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(O))},e.exports=o},{"./common.js":3}],8:[function(t,e,n){var r=t("./common.js"),o=t("./mat3.js"),a=t("./vec3.js"),i=t("./vec4.js"),s={};s.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=a.create(),e=a.fromValues(1,0,0),n=a.fromValues(0,1,0);return function(r,o,i){var u=a.dot(o,i);return-.999999>u?(a.cross(t,e,o),a.length(t)<1e-6&&a.cross(t,n,o),a.normalize(t,t),s.setAxisAngle(r,t,Math.PI),r):u>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(a.cross(t,o,i),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+u,s.normalize(r,r))}}(),s.setAxes=function(){var t=o.create();return function(e,n,r,o){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=o[0],t[4]=o[1],t[7]=o[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=i.clone,s.fromValues=i.fromValues,s.copy=i.copy,s.set=i.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,n){n=.5*n;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},s.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n},s.add=i.add,s.multiply=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=r*c+i*s+o*l-a*u,t[1]=o*c+i*u+a*s-r*l,t[2]=a*c+i*l+r*u-o*s,t[3]=i*c-r*s-o*u-a*l,t},s.mul=s.multiply,s.scale=i.scale,s.rotateX=function(t,e,n){n*=.5;var r=e[0],o=e[1],a=e[2],i=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=o*u+a*s,t[2]=a*u-o*s,t[3]=i*u-r*s,t},s.rotateY=function(t,e,n){n*=.5;var r=e[0],o=e[1],a=e[2],i=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-a*s,t[1]=o*u+i*s,t[2]=a*u+r*s,t[3]=i*u-o*s,t},s.rotateZ=function(t,e,n){n*=.5;var r=e[0],o=e[1],a=e[2],i=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=o*u-r*s,t[2]=a*u+i*s,t[3]=i*u-a*s,t},s.calculateW=function(t,e){var n=e[0],r=e[1],o=e[2];return t[0]=n,t[1]=r,t[2]=o,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o)),t},s.dot=i.dot,s.lerp=i.lerp,s.slerp=function(t,e,n,r){var o,a,i,s,u,l=e[0],c=e[1],h=e[2],f=e[3],d=n[0],p=n[1],m=n[2],M=n[3];return a=l*d+c*p+h*m+f*M,0>a&&(a=-a,d=-d,p=-p,m=-m,M=-M),1-a>1e-6?(o=Math.acos(a),i=Math.sin(o),s=Math.sin((1-r)*o)/i,u=Math.sin(r*o)/i):(s=1-r,u=r),t[0]=s*l+u*d,t[1]=s*c+u*p,t[2]=s*h+u*m,t[3]=s*f+u*M,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(n,r,o,a,i,u){return s.slerp(t,r,i,u),s.slerp(e,o,a,u),s.slerp(n,t,e,2*u*(1-u)),n}}(),s.invert=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=n*n+r*r+o*o+a*a,s=i?1/i:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-o*s,t[3]=a*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=i.length,s.len=s.length,s.squaredLength=i.squaredLength,s.sqrLen=s.squaredLength,s.normalize=i.normalize,s.fromMat3=function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var o=0;e[4]>e[0]&&(o=1),e[8]>e[3*o+o]&&(o=2);var a=(o+1)%3,i=(o+2)%3;n=Math.sqrt(e[3*o+o]-e[3*a+a]-e[3*i+i]+1),t[o]=.5*n,n=.5/n,t[3]=(e[3*a+i]-e[3*i+a])*n,t[a]=(e[3*a+o]+e[3*o+a])*n,t[i]=(e[3*i+o]+e[3*o+i])*n}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},s.exactEquals=i.exactEquals,s.equals=i.equals,e.exports=s},{"./common.js":3,"./mat3.js":6,"./vec3.js":10,"./vec4.js":11}],9:[function(t,e,n){var r=t("./common.js"),o={};o.create=function(){var t=new r.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},o.clone=function(t){var e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},o.fromValues=function(t,e){var n=new r.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},o.set=function(t,e,n){return t[0]=e,t[1]=n,t},o.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},o.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},o.sub=o.subtract,o.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},o.mul=o.multiply,o.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},o.div=o.divide,o.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},o.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},o.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},o.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},o.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},o.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},o.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},o.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},o.dist=o.distance,o.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},o.len=o.length,o.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},o.normalize=function(t,e){var n=e[0],r=e[1],o=n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},o.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},o.lerp=function(t,e,n,r){var o=e[0],a=e[1];return t[0]=o+r*(n[0]-o),t[1]=a+r*(n[1]-a),t},o.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},o.transformMat2=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o,t[1]=n[1]*r+n[3]*o,t},o.transformMat2d=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o+n[4],t[1]=n[1]*r+n[3]*o+n[5],t},o.transformMat3=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[3]*o+n[6],t[1]=n[1]*r+n[4]*o+n[7],t},o.transformMat4=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[4]*o+n[12],t[1]=n[1]*r+n[5]*o+n[13],t},o.forEach=function(){var t=o.create();return function(e,n,r,o,a,i){var s,u;for(n||(n=2),r||(r=0),u=o?Math.min(o*n+r,e.length):e.length,s=r;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],a(t,t,i),e[s]=t[0],e[s+1]=t[1];return e}}(),o.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},o.equals=function(t,e){var n=t[0],o=t[1],a=e[0],i=e[1];return Math.abs(n-a)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-i)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(i))},e.exports=o},{"./common.js":3}],10:[function(t,e,n){var r=t("./common.js"),o={};o.create=function(){var t=new r.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},o.clone=function(t){var e=new r.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},o.fromValues=function(t,e,n){var o=new r.ARRAY_TYPE(3);return o[0]=t,o[1]=e,o[2]=n,o},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},o.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},o.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},o.sub=o.subtract,o.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},o.mul=o.multiply,o.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},o.div=o.divide,o.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},o.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},o.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},o.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},o.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},o.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},o.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},o.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)},o.dist=o.distance,o.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return n*n+r*r+o*o},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},o.len=o.length,o.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},o.normalize=function(t,e){var n=e[0],r=e[1],o=e[2],a=n*n+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},o.cross=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=n[0],s=n[1],u=n[2];return t[0]=o*u-a*s,t[1]=a*i-r*u,t[2]=r*s-o*i,t},o.lerp=function(t,e,n,r){var o=e[0],a=e[1],i=e[2];return t[0]=o+r*(n[0]-o),t[1]=a+r*(n[1]-a),t[2]=i+r*(n[2]-i),t},o.hermite=function(t,e,n,r,o,a){var i=a*a,s=i*(2*a-3)+1,u=i*(a-2)+a,l=i*(a-1),c=i*(3-2*a);return t[0]=e[0]*s+n[0]*u+r[0]*l+o[0]*c,t[1]=e[1]*s+n[1]*u+r[1]*l+o[1]*c,t[2]=e[2]*s+n[2]*u+r[2]*l+o[2]*c,t},o.bezier=function(t,e,n,r,o,a){var i=1-a,s=i*i,u=a*a,l=s*i,c=3*a*s,h=3*u*i,f=u*a;return t[0]=e[0]*l+n[0]*c+r[0]*h+o[0]*f,t[1]=e[1]*l+n[1]*c+r[1]*h+o[1]*f,t[2]=e[2]*l+n[2]*c+r[2]*h+o[2]*f,t},o.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI,o=2*r.RANDOM()-1,a=Math.sqrt(1-o*o)*e;return t[0]=Math.cos(n)*a,t[1]=Math.sin(n)*a,t[2]=o*e,t},o.transformMat4=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=n[3]*r+n[7]*o+n[11]*a+n[15];return i=i||1,t[0]=(n[0]*r+n[4]*o+n[8]*a+n[12])/i,t[1]=(n[1]*r+n[5]*o+n[9]*a+n[13])/i,t[2]=(n[2]*r+n[6]*o+n[10]*a+n[14])/i,t},o.transformMat3=function(t,e,n){var r=e[0],o=e[1],a=e[2];return t[0]=r*n[0]+o*n[3]+a*n[6],t[1]=r*n[1]+o*n[4]+a*n[7],t[2]=r*n[2]+o*n[5]+a*n[8],t},o.transformQuat=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*a-u*o,h=l*o+u*r-i*a,f=l*a+i*o-s*r,d=-i*r-s*o-u*a;return t[0]=c*l+d*-i+h*-u-f*-s,t[1]=h*l+d*-s+f*-i-c*-u,t[2]=f*l+d*-u+c*-s-h*-i,t},o.rotateX=function(t,e,n,r){var o=[],a=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],a[0]=o[0],a[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),a[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},o.rotateY=function(t,e,n,r){var o=[],a=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],a[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),a[1]=o[1],a[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},o.rotateZ=function(t,e,n,r){var o=[],a=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],a[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),a[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),a[2]=o[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},o.forEach=function(){var t=o.create();return function(e,n,r,o,a,i){var s,u;for(n||(n=3),r||(r=0),u=o?Math.min(o*n+r,e.length):e.length,s=r;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,i),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),o.angle=function(t,e){var n=o.fromValues(t[0],t[1],t[2]),r=o.fromValues(e[0],e[1],e[2]);o.normalize(n,n),o.normalize(r,r);var a=o.dot(n,r);return a>1?0:Math.acos(a)},o.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},o.equals=function(t,e){var n=t[0],o=t[1],a=t[2],i=e[0],s=e[1],u=e[2];return Math.abs(n-i)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(o-s)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(a-u)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))},e.exports=o},{"./common.js":3}],11:[function(t,e,n){var r=t("./common.js"),o={};o.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},o.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},o.fromValues=function(t,e,n,o){var a=new r.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=o,a},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},o.set=function(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t},o.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},o.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},o.sub=o.subtract,o.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},o.mul=o.multiply,o.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},o.div=o.divide,o.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},o.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},o.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},o.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},o.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},o.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},o.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},o.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],a=e[3]-t[3];return Math.sqrt(n*n+r*r+o*o+a*a)},o.dist=o.distance,o.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],a=e[3]-t[3];return n*n+r*r+o*o+a*a},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],n=t[1],r=t[2],o=t[3];return Math.sqrt(e*e+n*n+r*r+o*o)},o.len=o.length,o.squaredLength=function(t){var e=t[0],n=t[1],r=t[2],o=t[3];return e*e+n*n+r*r+o*o},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},o.normalize=function(t,e){var n=e[0],r=e[1],o=e[2],a=e[3],i=n*n+r*r+o*o+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=n*i,t[1]=r*i,t[2]=o*i,t[3]=a*i),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},o.lerp=function(t,e,n,r){var o=e[0],a=e[1],i=e[2],s=e[3];return t[0]=o+r*(n[0]-o),t[1]=a+r*(n[1]-a),t[2]=i+r*(n[2]-i),t[3]=s+r*(n[3]-s),t},o.random=function(t,e){return e=e||1,t[0]=r.RANDOM(),t[1]=r.RANDOM(),t[2]=r.RANDOM(),t[3]=r.RANDOM(),o.normalize(t,t),o.scale(t,t,e),t},o.transformMat4=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*a+n[12]*i,t[1]=n[1]*r+n[5]*o+n[9]*a+n[13]*i,t[2]=n[2]*r+n[6]*o+n[10]*a+n[14]*i,t[3]=n[3]*r+n[7]*o+n[11]*a+n[15]*i,t},o.transformQuat=function(t,e,n){var r=e[0],o=e[1],a=e[2],i=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*a-u*o,h=l*o+u*r-i*a,f=l*a+i*o-s*r,d=-i*r-s*o-u*a;return t[0]=c*l+d*-i+h*-u-f*-s,t[1]=h*l+d*-s+f*-i-c*-u,t[2]=f*l+d*-u+c*-s-h*-i,t[3]=e[3],t},o.forEach=function(){var t=o.create();return function(e,n,r,o,a,i){var s,u;for(n||(n=4),r||(r=0),u=o?Math.min(o*n+r,e.length):e.length,s=r;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,i),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),o.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},o.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},o.equals=function(t,e){var n=t[0],o=t[1],a=t[2],i=t[3],s=e[0],u=e[1],l=e[2],c=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-u)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(a-l)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(i-c)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},e.exports=o},{"./common.js":3}],12:[function(t,e,n){(function(t){function e(t,e){for(var n=0,r=t.length-1;r>=0;r--){var o=t[r];"."===o?t.splice(r,1):".."===o?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,a=function(t){return o.exec(t).slice(1)};n.resolve=function(){for(var n="",o=!1,a=arguments.length-1;a>=-1&&!o;a--){var i=a>=0?arguments[a]:t.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(n=i+"/"+n,o="/"===i.charAt(0))}return n=e(r(n.split("/"),function(t){return!!t}),!o).join("/"),(o?"/":"")+n||"."},n.normalize=function(t){var o=n.isAbsolute(t),a="/"===i(t,-1);return t=e(r(t.split("/"),function(t){return!!t}),!o).join("/"),t||o||(t="."),t&&a&&(t+="/"),(o?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var o=r(t.split("/")),a=r(e.split("/")),i=Math.min(o.length,a.length),s=i,u=0;i>u;u++)if(o[u]!==a[u]){s=u;break}for(var l=[],u=s;u<o.length;u++)l.push("..");return l=l.concat(a.slice(s)),l.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){var e=a(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},n.basename=function(t,e){var n=a(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return a(t)[3]};var i="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return 0>e&&(e=t.length+e),t.substr(e,n)}}).call(this,t("_process"))},{_process:13}],13:[function(t,e,n){function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(h===setTimeout)return setTimeout(t,0);if((h===r||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function i(t){if(f===clearTimeout)return clearTimeout(t);if((f===o||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function s(){M&&p&&(M=!1,p.length?m=p.concat(m):x=-1,m.length&&u())}function u(){if(!M){var t=a(s);M=!0;for(var e=m.length;e;){for(p=m,m=[];++x<e;)p&&p[x].run();x=-1,e=m.length}p=null,M=!1,i(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var h,f,d=e.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:r}catch(t){h=r}try{f="function"==typeof clearTimeout?clearTimeout:o}catch(t){f=o}}();var p,m=[],M=!1,x=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];m.push(new l(t,e)),1!==m.length||M||a(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(t){return[]},d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],14:[function(t,e,n){"use strict";var r=t("./hakurei").core,o=t("./hakurei").util,a=t("./scene/stage"),i=function(t){r.apply(this,arguments)};o.inherit(i,r),i.prototype.init=function(){r.prototype.init.apply(this,arguments),this.addScene("stage",new a(this)),this.changeSceneWithLoading("stage",{images:{player:"./image/marisa.png",bg:"./image/bg1.jpg",bullet:"./image/bullet_pack.png"}})},e.exports=i},{"./hakurei":15,"./scene/stage":33}],15:[function(t,e,n){"use strict";e.exports=t("./hakureijs/index")},{"./hakureijs/index":21}],16:[function(t,e,n){"use strict";var r=function(){this.sounds={},this.bgms={},this.loading_audio_num=0,this.loaded_audio_num=0,this.id=0,this.soundflag=0,this.audio_context=null,window&&window.AudioContext&&(this.audio_context=new window.AudioContext,this.audio_context.createGain=this.audio_context.createGain||this.audio_context.createGainNode),this.audio_source=null};r.prototype.init=function(){this.sounds={},this.bgms={},this.loading_audio_num=0,this.loaded_audio_num=0,this.id=0,this.soundflag=0},r.prototype.loadSound=function(t,e,n){var r=this;r.loading_audio_num++,n||(n=1);var o=function(){r.loaded_audio_num++},a=new Audio(e);a.volume=n,a.addEventListener("canplay",o),a.load(),r.sounds[t]={id:1<<r.id++,audio:a}},r.prototype.loadBGM=function(t,e,n,r,o){var a=this;a.loading_audio_num++;var i=function(e){a.loaded_audio_num++,a.bgms[t]={audio:e,volume:n,loopStart:r,loopEnd:o}},s=function(t){throw t instanceof Error?new Error(t.message):t},u=new XMLHttpRequest;u.onload=function(){if(200===u.status){var t=u.response;a.audio_context.decodeAudioData(t,i,s)}},u.open("GET",e,!0),u.responseType="arraybuffer",u.send(null)},r.prototype.isAllLoaded=function(){return this.loaded_audio_num===this.loading_audio_num},r.prototype.playSound=function(t){this.soundflag|=this.sounds[t].id},r.prototype.executePlaySound=function(){for(var t in this.sounds)this.soundflag&this.sounds[t].id&&(this.sounds[t].audio.pause(),this.sounds[t].audio.currentTime=0,this.sounds[t].audio.play(),this.soundflag&=~this.sounds[t].id)},r.prototype.playBGM=function(t){var e=this;e.stopBGM(),e.audio_source=e._createSourceNode(t),e.audio_source.start(0)},r.prototype.stopBGM=function(){var t=this;t.isPlayingBGM()&&(t.audio_source.stop(0),t.audio_source=null)},r.prototype.isPlayingBGM=function(){return this.audio_source?!0:!1},r.prototype._createSourceNode=function(t){var e=this,n=e.bgms[t],r=e.audio_context.createBufferSource();r.buffer=n.audio,(n.loopStart||n.loopEnd)&&(r.loop=!0),n.loopStart&&(r.loopStart=n.loopStart),n.loopEnd&&(r.loopEnd=n.loopEnd);var o=this.audio_context.createGain();return o.gain.value=n.volume||1,r.connect(o),o.connect(e.audio_context.destination),r.start=r.start||r.noteOn,r.stop=r.stop||r.noteOff,r},r.prototype.progress=function(){return this.loaded_audio_num/this.loading_audio_num},e.exports=r},{}],17:[function(t,e,n){"use strict";var r=function(){this.is_done=!1};r.prototype.init=function(){this.is_done=!1},r.prototype.isAllLoaded=function(){return this.is_done},r.prototype.notifyLoadingDone=function(){this.is_done=!0},r.prototype.progress=function(){return this.is_done?1:0},e.exports=r},{}],18:[function(t,e,n){"use strict";var r=function(){this.images={},this.loading_image_num=0,this.loaded_image_num=0};r.prototype.init=function(){for(var t in this.images)this.images[t].src="";this.images={},this.loading_image_num=0,this.loaded_image_num=0},r.prototype.loadImage=function(t,e){var n=this;n.loading_image_num++;var r=function(){n.loaded_image_num++},o=new Image;o.src=e,o.onload=r,this.images[t]=o},r.prototype.isAllLoaded=function(){return this.loaded_image_num===this.loading_image_num},r.prototype.getImage=function(t){return this.images[t]},r.prototype.progress=function(){return this.loaded_image_num/this.loading_image_num},e.exports=r},{}],19:[function(t,e,n){"use strict";var r={BUTTON_LEFT:1,BUTTON_UP:2,BUTTON_RIGHT:4,BUTTON_DOWN:8,BUTTON_Z:16,BUTTON_X:32,BUTTON_SHIFT:64,BUTTON_SPACE:128};e.exports=r},{}],20:[function(t,e,n){"use strict";var r=t("webgl-debug"),o=t("./constant"),a=t("./asset_loader/image"),i=t("./asset_loader/audio"),s=t("./asset_loader/font"),u=t("./scene/loading"),l=function(t,e){e||(e={}),this.canvas_dom=t,this.ctx=null,this.gl=null,e.webgl?this.gl=this.createWebGLContext(this.canvas_dom):this.ctx=this.canvas_dom.getContext("2d"),this.width=Number(t.getAttribute("width")),this.height=Number(t.getAttribute("height")),this.current_scene=null,this._reserved_next_scene=null,this.scenes={},this.frame_count=0,this.request_id=null,this.current_keyflag=0,this.before_keyflag=0,this.is_left_clicked=!1,this.is_right_clicked=!1,this.before_is_left_clicked=!1,this.before_is_right_clicked=!1,this.mouse_change_x=0,this.mouse_change_y=0,this.mouse_x=0,this.mouse_y=0,this.mouse_scroll=0,this.is_connect_gamepad=!1,this.image_loader=new a,this.audio_loader=new i,this.font_loader=new s};l.prototype.init=function(){this.current_scene=null,this._reserved_next_scene=null,this.frame_count=0,this.request_id=null,this.current_keyflag=0,this.before_keyflag=0,this.is_left_clicked=!1,this.is_right_clicked=!1,this.before_is_left_clicked=!1,this.before_is_right_clicked=!1,this.mouse_change_x=0,this.mouse_change_y=0,this.mouse_x=0,this.mouse_y=0,this.mouse_scroll=0,this.image_loader.init(),this.audio_loader.init(),this.font_loader.init(),this.addScene("loading",new u(this))},l.prototype.enableGamePad=function(){this.is_connect_gamepad=!0},l.prototype.isRunning=function(){return this.request_id?!0:!1},l.prototype.startRun=function(){this.isRunning()||this.run()},l.prototype.run=function(){this.handleGamePad(),this.changeNextSceneIfReserved(),this.audio_loader.executePlaySound();var t=this.currentScene();t&&(t.beforeDraw(),this.clearCanvas(),t.draw(),t.afterDraw()),this.before_keyflag=this.current_keyflag,this.before_is_left_clicked=this.is_left_clicked,this.before_is_right_clicked=this.is_right_clicked,this.mouse_scroll=0,this.mouse_change_x=0,this.mouse_change_y=0,this.frame_count++,this.request_id=requestAnimationFrame(this.run.bind(this))},l.prototype.currentScene=function(){return null!==this.current_scene?this.scenes[this.current_scene]:void 0},l.prototype.addScene=function(t,e){this.scenes[t]=e},l.prototype.changeScene=function(){var t=Array.prototype.slice.call(arguments);this._reserved_next_scene=t},l.prototype.changeNextSceneIfReserved=function(){if(this._reserved_next_scene){this.current_scene=this._reserved_next_scene.shift();var t=this.currentScene();t.init.apply(t,this._reserved_next_scene),this._reserved_next_scene=null}},
l.prototype.changeSceneWithLoading=function(t,e){e||(e={}),this.changeScene("loading",e,t)},l.prototype.clearCanvas=function(){this.is2D()?this.ctx.clearRect(0,0,this.width,this.height):this.is3D()&&(this.gl.clearColor(0,0,0,0),this.gl.clearDepth(1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT))},l.prototype.is2D=function(){return this.ctx?!0:!1},l.prototype.is3D=function(){return this.gl?!0:!1},l.prototype.handleKeyDown=function(t){this.current_keyflag|=this._keyCodeToBitCode(t.keyCode),t.preventDefault()},l.prototype.handleKeyUp=function(t){this.current_keyflag&=~this._keyCodeToBitCode(t.keyCode),t.preventDefault()},l.prototype.isKeyDown=function(t){return this.current_keyflag&t?!0:!1},l.prototype.isKeyPush=function(t){return!(this.before_keyflag&t)&&this.current_keyflag&t},l.prototype.handleMouseDown=function(t){"which"in t?(this.is_left_clicked=1===t.which,this.is_right_clicked=3===t.which):"button"in t&&(this.is_left_clicked=1===t.button,this.is_right_clicked=2===t.button),t.preventDefault()},l.prototype.handleMouseUp=function(t){"which"in t?(this.is_left_clicked=1===t.which?!1:this.is_left_clicked,this.is_right_clicked=3===t.which?!1:this.is_right_clicked):"button"in t&&(this.is_left_clicked=1===t.button?!1:this.is_left_clicked,this.is_right_clicked=2===t.button?!1:this.is_right_clicked),t.preventDefault()},l.prototype.isLeftClickDown=function(){return this.is_left_clicked},l.prototype.isLeftClickPush=function(){return this.is_left_clicked&&!this.before_is_left_clicked},l.prototype.isRightClickDown=function(){return this.is_right_clicked},l.prototype.isRightClickPush=function(){return this.is_right_clicked&&!this.before_is_right_clicked},l.prototype.handleMouseMove=function(t){t=t?t:window.event,t.preventDefault(),this.mouse_change_x=this.mouse_x-t.clientX,this.mouse_change_y=this.mouse_y-t.clientY,this.mouse_x=t.clientX,this.mouse_y=t.clientY},l.prototype.mousePositionX=function(){return this.mouse_x},l.prototype.mousePositionY=function(){return this.mouse_y},l.prototype.mouseMoveX=function(){return this.mouse_change_x},l.prototype.mouseMoveY=function(){return this.mouse_change_y},l.prototype.handleMouseWheel=function(t){this.mouse_scroll=t.detail?t.detail:-t.wheelDelta/120},l.prototype.mouseScroll=function(){return this.mouse_scroll},l.prototype._keyCodeToBitCode=function(t){var e;switch(t){case 16:e=o.BUTTON_SHIFT;break;case 32:e=o.BUTTON_SPACE;break;case 37:e=o.BUTTON_LEFT;break;case 38:e=o.BUTTON_UP;break;case 39:e=o.BUTTON_RIGHT;break;case 40:e=o.BUTTON_DOWN;break;case 88:e=o.BUTTON_X;break;case 90:e=o.BUTTON_Z}return e},l.prototype.handleGamePad=function(){if(this.is_connect_gamepad){var t=navigator.getGamepads(),e=t[0];e&&(this.current_keyflag=0,this.current_keyflag|=e.buttons[1].pressed?o.BUTTON_Z:0,this.current_keyflag|=e.buttons[0].pressed?o.BUTTON_X:0,this.current_keyflag|=e.buttons[2].pressed?o.BUTTON_SELECT:0,this.current_keyflag|=e.buttons[3].pressed?o.BUTTON_START:0,this.current_keyflag|=e.buttons[4].pressed?o.BUTTON_SHIFT:0,this.current_keyflag|=e.buttons[5].pressed?o.BUTTON_SHIFT:0,this.current_keyflag|=e.buttons[6].pressed?o.BUTTON_SPACE:0,this.current_keyflag|=e.axes[1]<-.5?o.BUTTON_UP:0,this.current_keyflag|=e.axes[1]>.5?o.BUTTON_DOWN:0,this.current_keyflag|=e.axes[0]<-.5?o.BUTTON_LEFT:0,this.current_keyflag|=e.axes[0]>.5?o.BUTTON_RIGHT:0)}},l.prototype.fullscreen=function(){var t=this.canvas_dom;t.requestFullscreen?t.requestFullscreen():t.msRequestuestFullscreen?t.msRequestuestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()},l.prototype.fontLoadingDone=function(){this.font_loader.notifyLoadingDone()},l.prototype.setupEvents=function(){if(window){var t=this;window.AudioContext=function(){return window.AudioContext||window.webkitAudioContext}(),window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),window.document&&window.document.fonts?window.document.fonts.addEventListener("loadingdone",function(){t.fontLoadingDone()}):t.fontLoadingDone(),window.onkeydown=function(e){t.handleKeyDown(e)},window.onkeyup=function(e){t.handleKeyUp(e)},this.canvas_dom.onmousedown=function(e){t.handleMouseDown(e)},this.canvas_dom.onmouseup=function(e){t.handleMouseUp(e)},this.canvas_dom.onmousemove=function(e){t.handleMouseMove(e)};var e=window.navi&&/Firefox/i.test(window.navigator.userAgent)?"DOMMouseScroll":"mousewheel";this.canvas_dom.addEventListener&&this.canvas_dom.addEventListener(e,function(e){var n=window.event||e;t.handleMouseWheel(n)},!1),this.canvas_dom.oncontextmenu=function(){return!1},window.Gamepad&&window.navigator&&window.navigator.getGamepads&&t.enableGamePad()}},l.prototype.createWebGLContext=function(t){var e;try{e=t.getContext("webgl")||t.getContext("experimental-webgl"),e=r.makeDebugContext(e)}catch(n){throw n}if(!e)throw new Error("Could not initialize WebGL");return e},e.exports=l},{"./asset_loader/audio":16,"./asset_loader/font":17,"./asset_loader/image":18,"./constant":19,"./scene/loading":27,"webgl-debug":22}],21:[function(t,e,n){"use strict";e.exports={util:t("./util"),core:t("./core"),constant:t("./constant"),serif_manager:t("./serif_manager"),scene:{base:t("./scene/base"),loading:t("./scene/loading")},object:{base:t("./object/base"),sprite:t("./object/sprite"),pool_manager:t("./object/pool_manager")},asset_loader:{image:t("./asset_loader/image"),audio:t("./asset_loader/audio"),font:t("./asset_loader/font")},storage:{base:t("./storage/base"),save:t("./storage/save")}}},{"./asset_loader/audio":16,"./asset_loader/font":17,"./asset_loader/image":18,"./constant":19,"./core":20,"./object/base":23,"./object/pool_manager":24,"./object/sprite":25,"./scene/base":26,"./scene/loading":27,"./serif_manager":28,"./storage/base":29,"./storage/save":30,"./util":31}],22:[function(t,e,n){(function(t){WebGLDebugUtils=function(){function e(t){if(null==p){p={},m={};for(var e in t)"number"==typeof t[e]&&(p[t[e]]=e,m[e]=t[e])}}function n(){if(null==p)throw"WebGLDebugUtils.init(ctx) not called"}function r(t){return n(),void 0!==p[t]}function o(t){n();var e=p[t];return void 0!==e?"gl."+e:"/*UNKNOWN WebGL ENUM*/ 0x"+t.toString(16)}function a(t,e,n,r){var a=d[t];if(void 0!==a){var a=a[e];if(void 0!==a&&a[n]){if("object"==typeof a[n]&&void 0!==a[n].enumBitwiseOr){for(var i=a[n].enumBitwiseOr,s=0,u=[],l=0;l<i.length;++l){var c=m[i[l]];0!==(r&c)&&(s|=c,u.push(o(c)))}return s===r?u.join(" | "):o(r)}return o(r)}}return null===r?"null":void 0===r?"undefined":r.toString()}function i(t,e){for(var n="",r=e.length,o=0;r>o;++o)n+=(0==o?"":", ")+a(t,r,o,e[o]);return n}function s(t,e,n){t.__defineGetter__(n,function(){return e[n]}),t.__defineSetter__(n,function(t){e[n]=t})}function u(t,n,r,i){function l(t,e){return function(){r&&r(e,arguments);var o=t[e].apply(t,arguments),a=i.getError();return 0!=a&&(c[a]=!0,n(a,e,arguments)),o}}i=i||t,e(t),n=n||function(t,e,n){for(var r="",i=n.length,s=0;i>s;++s)r+=(0==s?"":", ")+a(e,i,s,n[s]);f("WebGL error "+o(t)+" in "+e+"("+r+")")};var c={},h={};for(var d in t)if("function"==typeof t[d])if("getExtension"!=d)h[d]=l(t,d);else{var p=l(t,d);h[d]=function(){var e=p.apply(t,arguments);return u(e,n,r,i)}}else s(h,t,d);return h.getError=function(){for(var e in c)if(c.hasOwnProperty(e)&&c[e])return c[e]=!1,e;return t.NO_ERROR},h}function l(t){var e=t.getParameter(t.MAX_VERTEX_ATTRIBS),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n);for(var r=0;e>r;++r)t.disableVertexAttribArray(r),t.vertexAttribPointer(r,4,t.FLOAT,!1,0,0),t.vertexAttrib1f(r,0);t.deleteBuffer(n);for(var o=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),r=0;o>r;++r)t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_CUBE_MAP,null),t.bindTexture(t.TEXTURE_2D,null);for(t.activeTexture(t.TEXTURE0),t.useProgram(null),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.DITHER),t.disable(t.SCISSOR_TEST),t.blendColor(0,0,0,0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.clearColor(0,0,0,0),t.clearDepth(1),t.clearStencil(-1),t.colorMask(!0,!0,!0,!0),t.cullFace(t.BACK),t.depthFunc(t.LESS),t.depthMask(!0),t.depthRange(0,1),t.frontFace(t.CCW),t.hint(t.GENERATE_MIPMAP_HINT,t.DONT_CARE),t.lineWidth(1),t.pixelStorei(t.PACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.UNPACK_COLORSPACE_CONVERSION_WEBGL&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.BROWSER_DEFAULT_WEBGL),t.polygonOffset(0,0),t.sampleCoverage(1,!1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilMask(4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT);t.getError(););}function c(t){function e(t){return"function"==typeof t?t:function(e){t.handleEvent(e)}}function n(t){var e=t.addEventListener;t.addEventListener=function(n,r,o){switch(n){case"webglcontextlost":I(r);break;case"webglcontextrestored":D(r);break;default:e.apply(t,arguments)}}}function r(){for(var t=Object.keys(v),e=0;e<t.length;++e)delete v[t]}function o(){++g,M||_==g&&t.loseContext()}function a(t,e){var n=t[e];return function(){if(o(),!M){var e=n.apply(t,arguments);return e}}}function i(){for(var t=0;t<x.length;++t){var e=x[t];e instanceof WebGLBuffer?h.deleteBuffer(e):e instanceof WebGLFramebuffer?h.deleteFramebuffer(e):e instanceof WebGLProgram?h.deleteProgram(e):e instanceof WebGLRenderbuffer?h.deleteRenderbuffer(e):e instanceof WebGLShader?h.deleteShader(e):e instanceof WebGLTexture&&h.deleteTexture(e)}}function u(t){return{statusMessage:t,preventDefault:function(){S=!0}}}function c(t){for(var e in t)"function"==typeof t[e]?f[e]=a(t,e):s(f,t,e);f.getError=function(){if(o(),!M)for(var t;t=h.getError();)v[t]=!0;for(var t in v)if(v[t])return delete v[t],t;return f.NO_ERROR};for(var n=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],r=0;r<n.length;++r){var i=n[r];f[i]=function(e){return function(){if(o(),M)return null;var n=e.apply(t,arguments);return n.__webglDebugContextLostId__=m,x.push(n),n}}(t[i])}for(var u=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"],r=0;r<u.length;++r){var i=u[r];f[i]=function(e){return function(){return o(),M?null:e.apply(t,arguments)}}(f[i])}for(var l=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"],r=0;r<l.length;++r){var i=l[r];f[i]=function(e){return function(){return o(),M?!1:e.apply(t,arguments)}}(f[i])}return f.checkFramebufferStatus=function(e){return function(){return o(),M?f.FRAMEBUFFER_UNSUPPORTED:e.apply(t,arguments)}}(f.checkFramebufferStatus),f.getAttribLocation=function(e){return function(){return o(),M?-1:e.apply(t,arguments)}}(f.getAttribLocation),f.getVertexAttribOffset=function(e){return function(){return o(),M?0:e.apply(t,arguments)}}(f.getVertexAttribOffset),f.isContextLost=function(){return M},f}var h,f,d=[],p=[],f={},m=1,M=!1,x=[],_=0,g=0,S=!1,b=0,v={};t.getContext=function(e){return function(){var n=e.apply(t,arguments);if(n instanceof WebGLRenderingContext){if(n!=h){if(h)throw"got different context";h=n,f=c(h)}return f}return n}}(t.getContext);var I=function(t){d.push(e(t))},D=function(t){p.push(e(t))};return n(t),t.loseContext=function(){if(!M){for(M=!0,_=0,++m;h.getError(););r(),v[h.CONTEXT_LOST_WEBGL]=!0;var e=u("context lost"),n=d.slice();setTimeout(function(){for(var r=0;r<n.length;++r)n[r](e);b>=0&&setTimeout(function(){t.restoreContext()},b)},0)}},t.restoreContext=function(){M&&p.length&&setTimeout(function(){if(!S)throw"can not restore. webglcontestlost listener did not call event.preventDefault";i(),l(h),M=!1,g=0,S=!1;for(var t=p.slice(),e=u("context restored"),n=0;n<t.length;++n)t[n](e)},0)},t.loseContextInNCalls=function(t){if(M)throw"You can not ask a lost contet to be lost";_=g+t},t.getNumCalls=function(){return g},t.setRestoreTimeout=function(t){b=t},t}"undefined"==typeof window&&(window=t);var h=function(t){window.console&&window.console.log&&window.console.log(t)},f=function(t){window.console&&window.console.error?window.console.error(t):h(t)},d={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},p=null,m=null;return{init:e,mightBeEnum:r,glEnumToString:o,glFunctionArgToString:a,glFunctionArgsToString:i,makeDebugContext:u,makeLostContextSimulatingCanvas:c,resetToInitialState:l}}(),e.exports=WebGLDebugUtils}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],23:[function(t,e,n){"use strict";var r=t("../util"),o=0,a=!1,i=function(t,e){this.scene=t,this.core=t.core,this.parent=e,this.id=++o,this.frame_count=0,this._x=0,this._y=0,this.auto_disable_times_map={},this.velocity={magnitude:0,theta:0},this.objects=[]};i.prototype.init=function(){this.frame_count=0,this._x=0,this._y=0,this.auto_disable_times_map={};for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].init()},i.prototype.beforeDraw=function(){this.frame_count++,this.checkAutoDisableFlags();for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].beforeDraw();this.move()},i.prototype.draw=function(){var t=this.core.ctx;a&&(t.save(),t.fillStyle="rgb( 255, 255, 255 )",t.globalAlpha=.4,t.fillRect(this.getCollisionLeftX(),this.getCollisionUpY(),this.collisionWidth(),this.collisionHeight()),t.restore());for(var e=0,n=this.objects.length;n>e;e++)this.objects[e].draw()},i.prototype.afterDraw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].afterDraw()},i.prototype.addSubObject=function(t){this.objects.push(t)},i.prototype.removeSubObject=function(t){for(var e=0,n=this.objects.length;n>e;e++)if(this.objects[e].id===t.id){this.objects.splice(e,1);break}},i.prototype.move=function(){var t=r.calcMoveXByVelocity(this.velocity),e=r.calcMoveYByVelocity(this.velocity);this._x+=t,this._y+=e},i.prototype.onCollision=function(){},i.prototype.width=function(){return 0},i.prototype.height=function(){return 0},i.prototype.globalCenterX=function(){return this.scene.x()+this.x()},i.prototype.globalCenterY=function(){return this.scene.y()+this.y()},i.prototype.globalLeftX=function(){return this.scene.x()+this.x()-this.width()/2},i.prototype.globalRightX=function(){return this.scene.x()+this.x()+this.width()/2},i.prototype.globalUpY=function(){return this.scene.x()+this.y()-this.height()/2},i.prototype.globalDownY=function(){return this.scene.x()+this.y()+this.height()/2},i.prototype.collisionWidth=function(){return 0},i.prototype.collisionHeight=function(){return 0},i.prototype.checkCollisionWithObject=function(t){var e=this;t.checkCollision(e)&&(t.onCollision(e),e.onCollision(t))},i.prototype.checkCollisionWithObjects=function(t){for(var e=this,n=0;n<t.length;n++){var r=t[n];e.checkCollision(r)&&(e.onCollision(r),r.onCollision(e))}},i.prototype.checkCollision=function(t){return Math.abs(this.x()-t.x())<this.collisionWidth()/2+t.collisionWidth()/2&&Math.abs(this.y()-t.y())<this.collisionHeight()/2+t.collisionHeight()/2?!0:!1},i.prototype.getCollisionLeftX=function(){return this.x()-this.collisionWidth()/2},i.prototype.getCollisionRightX=function(){return this.x()+this.collisionWidth()/2},i.prototype.getCollisionUpY=function(){return this.y()-this.collisionHeight()/2},i.prototype.getCollisionDownY=function(){return this.y()+this.collisionHeight()/2},i.prototype.setAutoDisableFlag=function(t,e){var n=this;n[t]=!0,n.auto_disable_times_map[t]=n.frame_count+e},i.prototype.checkAutoDisableFlags=function(){var t=this;for(var e in t.auto_disable_times_map)this.auto_disable_times_map[e]<t.frame_count&&(t[e]=!1,delete t.auto_disable_times_map[e])},i.prototype.x=function(t){return"undefined"!=typeof t&&(this._x=t),this._x},i.prototype.y=function(t){return"undefined"!=typeof t&&(this._y=t),this._y},i.prototype.setVelocity=function(t){this.velocity=t},e.exports=i},{"../util":31}],24:[function(t,e,n){"use strict";var r=t("./base"),o=t("../util"),a=function(t,e){r.apply(this,arguments),this.Class=e,this.objects={}};o.inherit(a,r),a.prototype.init=function(){r.prototype.init.apply(this,arguments),this.objects={}},a.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments);for(var t in this.objects)this.objects[t].beforeDraw()},a.prototype.draw=function(){r.prototype.draw.apply(this,arguments);for(var t in this.objects)this.objects[t].draw()},a.prototype.afterDraw=function(){r.prototype.afterDraw.apply(this,arguments);for(var t in this.objects)this.objects[t].afterDraw()},a.prototype.create=function(){var t=new this.Class(this.scene);return t.init.apply(t,arguments),this.objects[t.id]=t,t},a.prototype.remove=function(t){delete this.objects[t]},a.prototype.checkCollisionWithObject=function(t){for(var e in this.objects){var n=this.objects[e];t.checkCollision(n)&&(t.onCollision(n),n.onCollision(t))}},a.prototype.checkCollisionWithManager=function(t){for(var e in this.objects)for(var n in t.objects)if(this.objects[e].checkCollision(t.objects[n])){var r=this.objects[e],o=t.objects[n];if(r.onCollision(o),o.onCollision(r),!this.objects[e])break}},e.exports=a},{"../util":31,"./base":23}],25:[function(t,e,n){"use strict";var r=t("./base"),o=t("../util"),a=function(t){r.apply(this,arguments),this.current_sprite_index=0};o.inherit(a,r),a.prototype.init=function(){r.prototype.init.apply(this,arguments),this.current_sprite_index=0},a.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments),this.frame_count%this.spriteAnimationSpan()===0&&(this.current_sprite_index++,this.current_sprite_index>=this.spriteIndices().length&&(this.current_sprite_index=0))},a.prototype.draw=function(){if(this.isShow()){var t=this.core.image_loader.getImage(this.spriteName());this.scale()&&console.error("scale method is deprecated. you should use scaleWidth and scaleHeight.");var e=this.core.ctx;e.save(),e.translate(this.globalCenterX(),this.globalCenterY());var n=o.thetaToRadian(this.velocity.theta+this.rotateAdjust());e.rotate(n);var a=this.spriteWidth(),i=this.spriteHeight();a||(a=t.width),i||(i=t.height);var s=this.width(),u=this.height();this.isReflect()&&e.transform(-1,0,0,1,0,0),e.drawImage(t,a*this.spriteIndexX(),i*this.spriteIndexY(),a,i,-s/2,-u/2,s,u),e.restore()}r.prototype.draw.apply(this,arguments)},a.prototype.spriteName=function(){throw new Error("spriteName method must be overridden.")},a.prototype.spriteIndexX=function(){return this.spriteIndices()[this.current_sprite_index].x},a.prototype.spriteIndexY=function(){return this.spriteIndices()[this.current_sprite_index].y},a.prototype.width=function(){return this.spriteWidth()*this.scaleWidth()},a.prototype.height=function(){return this.spriteHeight()*this.scaleHeight()},a.prototype.isShow=function(){return!0},a.prototype.spriteAnimationSpan=function(){return 0},a.prototype.spriteIndices=function(){return[{x:0,y:0}]},a.prototype.spriteWidth=function(){return 0},a.prototype.spriteHeight=function(){return 0},a.prototype.rotateAdjust=function(){return 0},a.prototype.scale=function(){return 0},a.prototype.scaleWidth=function(){return 1},a.prototype.scaleHeight=function(){return 1},a.prototype.isReflect=function(){return!1},e.exports=a},{"../util":31,"./base":23}],26:[function(t,e,n){"use strict";var r=function(t,e){this.core=t,this.parent=e,this.width=this.core.width,this.height=this.core.height,this._x=0,this._y=0,this.frame_count=0,this.objects=[],this.current_scene=null,this._reserved_next_scene=null,this.scenes={}};r.prototype.init=function(){this.current_scene=null,this._reserved_next_scene=null,this._x=0,this._y=0,this.frame_count=0;for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].init()},r.prototype.beforeDraw=function(){this.frame_count++,this.changeNextSubSceneIfReserved();for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].beforeDraw();this.currentSubScene()&&this.currentSubScene().beforeDraw()},r.prototype.draw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].draw();this.currentSubScene()&&this.currentSubScene().draw()},r.prototype.afterDraw=function(){for(var t=0,e=this.objects.length;e>t;t++)this.objects[t].afterDraw();this.currentSubScene()&&this.currentSubScene().afterDraw()},r.prototype.addObject=function(t){this.objects.push(t)},r.prototype.currentSubScene=function(){return null!==this.current_scene?this.scenes[this.current_scene]:void 0},r.prototype.addSubScene=function(t,e){this.scenes[t]=e},r.prototype.changeSubScene=function(){var t=Array.prototype.slice.call(arguments);this._reserved_next_scene=t},r.prototype.changeNextSubSceneIfReserved=function(){if(this._reserved_next_scene){this.current_scene=this._reserved_next_scene.shift();var t=this.currentSubScene();t.init.apply(t,this._reserved_next_scene),this._reserved_next_scene=null}},r.prototype.x=function(t){return"undefined"!=typeof t&&(this._x=t),this._x},r.prototype.y=function(t){return"undefined"!=typeof t&&(this._y=t),this._y},e.exports=r},{}],27:[function(t,e,n){"use strict";var r=t("./base"),o=t("../util"),a=function(t){r.apply(this,arguments),this.next_scene_name=null};o.inherit(a,r),a.prototype.init=function(t,e){r.prototype.init.apply(this,arguments);var n=t.images||[],o=t.sounds||[],a=t.bgms||[];this.next_scene_name=e;for(var i in n)this.core.image_loader.loadImage(i,n[i]);for(var s in o){var u=o[s];this.core.audio_loader.loadSound(s,u.path,u.volume)}for(var l in a){var c=a[l];this.core.audio_loader.loadBGM(l,c.path,1,c.loopStart,c.loopEnd)}},a.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments),this.core.image_loader.isAllLoaded()&&this.core.audio_loader.isAllLoaded()&&this.notifyAllLoaded()},a.prototype.progress=function(){var t=(this.core.audio_loader.progress()+this.core.image_loader.progress()+this.core.font_loader.progress())/3;return t},a.prototype.draw=function(){r.prototype.draw.apply(this,arguments)},a.prototype.notifyAllLoaded=function(){this.next_scene_name&&this.core.changeScene(this.next_scene_name)},e.exports=a},{"../util":31,"./base":26}],28:[function(t,e,n){"use strict";var r=function(){this.timeoutID=null,this.script=null,this.progress=null,this.left_chara_id=null,this.left_exp=null,this.right_chara_id=null,this.right_exp=null,this.pos=null,this.line_num=0,this.printing_lines=[]};r.prototype.init=function(t){t||console.error("set script arguments to use serif_manager class"),this.script=t,this.progress=-1,this.timeoutID=null,this.left_chara_id=null,this.left_exp=null,this.right_chara_id=null,this.right_exp=null,this.pos=null,this.line_num=0,this.printing_lines=[],this.is_end()||this.next()},r.prototype.is_end=function(){return this.progress+1===this.script.length},r.prototype.next=function(){this.progress++;var t=this.script[this.progress];this._showChara(t),t.serif?this._printMessage(t.serif):this.next()},r.prototype._showChara=function(t){t.pos&&(this.pos=t.pos,"left"===t.pos?(this.left_chara_id=t.chara,this.left_exp=t.exp):"right"===t.pos&&(this.right_chara_id=t.chara,this.right_exp=t.exp))},r.prototype._printMessage=function(t){var e=this;null!==e.timeoutID&&(clearTimeout(e.timeoutID),e.timeoutID=null);var n=t.split(""),r=n.length,o=0;e.line_num=0,e.printing_lines=[];var a=function(){if(!(o>=r)){var t=10,i=n[o];o++,"\n"===i?e.line_num++:(e.printing_lines[e.line_num]||(e.printing_lines[e.line_num]=""),e.printing_lines[e.line_num]=e.printing_lines[e.line_num]+i),e.timeoutID=setTimeout(a,t)}};a()},r.prototype.right_image=function(){return this.right_chara_id?this.right_chara_id+"_"+this.right_exp:null},r.prototype.left_image=function(){return this.left_chara_id?this.left_chara_id+"_"+this.left_exp:null},r.prototype.right_name=function(){return this.right_chara_id?"name_"+this.right_chara_id:null},r.prototype.left_name=function(){return this.left_chara_id?"name_"+this.left_chara_id:null},r.prototype.is_left_talking=function(){return"left"===this.pos?!0:!1},r.prototype.is_right_talking=function(){return"right"===this.pos?!0:!1},r.prototype.lines=function(){return this.printing_lines},e.exports=r},{}],29:[function(t,e,n){(function(n){"use strict";var r="hakurei_engine_game:default",o=function(t){t||(t={}),this._data=t};o.KEY=function(){return r},o.isLocalMode=function(){return"function"==typeof t&&"object"==typeof n&&"browser"!==n.title},o.prototype.save=function(){var t=this.constructor;t.isLocalMode()?this._saveToLocalFile():this._saveToWebStorage()},o.prototype._saveToLocalFile=function(){var e=this.constructor,n=t("fs"),r=JSON.stringify(this._data),o=e._localFileDirectoryPath(),a=o+e._localFileName(e.KEY());n.existsSync(o)||n.mkdirSync(o),n.writeFileSync(a,r)},o._localFileDirectoryPath=function(){var e=t("path"),r=e.dirname(n.mainModule.filename);return e.join(r,"save/")},o._localFileName=function(t){return t+".json"},o._localFilePath=function(t){return this._localFileDirectoryPath()+this._localFileName(t)},o.prototype._saveToWebStorage=function(){var t=this.constructor,e=t.KEY(),n=JSON.stringify(this._data);try{window.localStorage.setItem(e,n)}catch(r){}},o.load=function(){return this.isLocalMode()?this._loadFromLocalFile():this._loadFromWebStorage()},o._loadFromLocalFile=function(){var e=t("fs"),n=this.localFilePath(this.KEY());if(!e.existsSync())return null;var r=e.readFileSync(n,{encoding:"utf8"}),o=this;return r?new o(JSON.parse(r)):null},o._loadFromWebStorage=function(){var t,e=this.KEY();try{t=window.localStorage.getItem(e)}catch(n){}var r=this;return t?new r(JSON.parse(t)):null},o.prototype.del=function(){var t=this.constructor;t.isLocalMode()?this._removeLocalFile():this._removeWebStorage()},o.prototype._removeLocalFile=function(){var e=this.constructor,n=t("fs"),r=this.localFilePath(e.KEY());n.existsSync(r)&&n.unlinkSync(r)},o.prototype._removeWebStorage=function(){var t=this.constructor,e=t.KEY();try{window.localStorage.removeItem(e)}catch(n){}},e.exports=o}).call(this,t("_process"))},{_process:13,fs:1,path:12}],30:[function(t,e,n){"use strict";var r=t("./base"),o=t("../util"),a=function(t){r.apply(this,arguments)};o.inherit(a,r),a.KEY=function(){var t="hakurei_engine_game:save";return window&&window.location?t+":"+window.location.pathname:t},e.exports=a},{"../util":31,"./base":29}],31:[function(t,e,n){"use strict";var r={inherit:function(t,e){var n=function(t){if(Object.create)return Object.create(t);var e=function(){};return e.prototype=t,new e};t.prototype=n(e.prototype),t.prototype.constructor=t;for(var r in e)t[r]=e[r]},radianToTheta:function(t){return 180*t/Math.PI|0},thetaToRadian:function(t){return t*Math.PI/180},calcMoveXByVelocity:function(t){return t.magnitude*Math.cos(r.thetaToRadian(t.theta))},calcMoveYByVelocity:function(t){return t.magnitude*Math.sin(r.thetaToRadian(t.theta))},hexToRGBString:function(t){var e="#"===t.charAt(0)?t.substring(1,7):t,n=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),o=parseInt(e.substring(4,6),16);return"rgb("+n+", "+r+", "+o+")"},clamp:function(t,e,n){return e>t?e:t>n?n:t}};e.exports=r},{}],32:[function(t,e,n){"use strict";var r,o=t("./game");window.onload=function(){var t=document.getElementById("mainCanvas"),e={webgl:!0};r=new o(t,e),r.setupEvents(),r.init(),r.startRun()}},{"./game":14}],33:[function(t,e,n){"use strict";var r=t("../hakurei").scene.base,o=t("../hakurei").util,a=(t("../hakurei").constant,t("../shader_program")),i=t("../shader/main.vs"),s=t("../shader/main.fs"),u=(t("gl-matrix"),function(t){r.apply(this,arguments)});o.inherit(u,r),u.prototype.init=function(){r.prototype.init.apply(this,arguments),this.shader_program=new a(this.core.gl,i,s,["aVertexPosition","aTextureCoordinates","aColor"],["uMVMatrix","uPMatrix","uSampler"])},u.prototype.beforeDraw=function(){r.prototype.beforeDraw.apply(this,arguments)},u.prototype.draw=function(){this.core.gl},u.prototype.renderMyon=function(){this.core.gl.uniformMatrix4fv(this.shader_program.uniform_locations.mvpMatrix,!1,this.mvpMatrix),this.attribSetup(this.shader_program.attribute_locations.position,this.myon.positionObject,3),this.attribSetup(this.shader_program.attribute_locations.color,this.myon.colorObject,4),this.attribSetup(this.shader_program.attribute_locations.textureCoord,this.myon.textureObject,2),this.core.gl.activeTexture(this.core.gl.TEXTURE0),this.core.gl.bindTexture(this.core.gl.TEXTURE_2D,this.myon.texture),this.core.gl.uniform1i(this.shader_program.uniform_locations.uSampler,0),this.core.gl.bindBuffer(this.core.gl.ELEMENT_ARRAY_BUFFER,this.myon.indexObject),this.core.gl.drawElements(this.core.gl.TRIANGLES,this.myon.numVertices(),this.core.gl.UNSIGNED_SHORT,0)},u.prototype.renderFPS=function(){this.core.gl.uniformMatrix4fv(this.shader_program.uniform_locations.mvpMatrix,!1,this.mvpMatrix),this.attribSetup(this.shader_program.attribute_locations.position,this.fps.positionObject,3),this.attribSetup(this.shader_program.attribute_locations.color,this.fps.colorObject,4),this.attribSetup(this.shader_program.attribute_locations.textureCoord,this.fps.textureObject,2),this.core.gl.activeTexture(this.core.gl.TEXTURE0),this.core.gl.bindTexture(this.core.gl.TEXTURE_2D,this.fps.texture),this.core.gl.uniform1i(this.shader_program.uniform_locations.uSampler,0),this.core.gl.bindBuffer(this.core.gl.ELEMENT_ARRAY_BUFFER,this.fps.indexObject),this.core.gl.drawElements(this.core.gl.TRIANGLES,this.fps.numVertices(),this.core.gl.UNSIGNED_SHORT,0)},u.prototype.attribSetup=function(t,e,n,r){r||(r=this.core.gl.FLOAT),this.core.gl.enableVertexAttribArray(t),this.core.gl.bindBuffer(this.core.gl.ARRAY_BUFFER,e),this.core.gl.vertexAttribPointer(t,n,r,!1,0,0)},e.exports=u},{"../hakurei":15,"../shader/main.fs":34,"../shader/main.vs":35,"../shader_program":36,"gl-matrix":2}],34:[function(t,e,n){e.exports="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoordinates;\nvarying vec4 vColor;\n\nvoid main() {\n	vec4 textureColor = texture2D(uSampler, vTextureCoordinates);\n	gl_FragColor = textureColor * vColor;\n}\n\n";
},{}],35:[function(t,e,n){e.exports="attribute vec3 aVertexPosition;\nattribute vec2 aTextureCoordinates;\nattribute vec4 aColor;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nvarying vec2 vTextureCoordinates;\nvarying vec4 vColor;\n\nvoid main() {\n	gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n	vTextureCoordinates = aTextureCoordinates;\n	vColor = aColor;\n}\n\n"},{}],36:[function(t,e,n){"use strict";var r=(t("gl-matrix"),function(t,e,n,r,o){if(!t)throw new Error("arguments 1 must be WebGLRenderingContext instance");this.gl=t;var a,i=this.createShader(t,t.VERTEX_SHADER,e),s=this.createShader(t,t.FRAGMENT_SHADER,n),u=this.createShaderProgram(t,i,s),l={};for(a=0;a<r.length;a++)l[r[a]]=t.getAttribLocation(u,r[a]);var c={};for(a=0;a<o.length;a++)c[o[a]]=t.getUniformLocation(u,o[a]);this.shader_program=u,this.attribute_locations=l,this.uniform_locations=c});r.prototype.createShader=function(t,e,n){if(e!==t.VERTEX_SHADER&&e!==t.FRAGMENT_SHADER)throw new Error("type must be vertex or fragment");var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw(e===t.VERTEX_SHADER?"Vertex":"Fragment")+" failed to compile:\n\n"+t.getShaderInfoLog(r);return r},r.prototype.createShaderProgram=function(t,e,n){var r=t.createProgram();if(t.attachShader(r,e),t.attachShader(r,n),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw new Error("Could not initialize shaders:\n\n"+t.getProgramInfoLog(r));return t.useProgram(r),r},r.prototype.useProgram=function(){this.gl.useProgram(this.shader_program)},e.exports=r},{"gl-matrix":2}]},{},[32]);